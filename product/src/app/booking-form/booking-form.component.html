<!DOCTYPE html>
<html>

<div class="booking-container">
  <h1>Book Your Spa Experience</h1>
  
  
  <div class="step-indicator">
    <div class="step" [class.active]="step >= 1">1. Select Services</div>
    <div class="step" [class.active]="step >= 2">2. Guest Details</div>
    <div class="step" [class.active]="step >= 3">3. Date & Time</div>
    <div class="step" [class.active]="step >= 4">4. Confirmation</div>
  </div>


  <div *ngIf="step === 1">
    <h2>Select Your Services</h2>
    
    <div *ngFor="let category of serviceCategories">
      <h3>{{category.categoryName}}</h3>
      <div class="service-grid">
        <div *ngFor="let service of category.products" 
             class="service-card"
             [class.selected]="selectedServices.find(s => s.id === service.id)"
             (click)="addService(service)">
          <img [src]="'../assets/services/' + service.imageFile + '.jpg'" 
               class="service-image"
               [alt]="service.name">
          <h4>{{service.name}}</h4>
          <p>{{service.description}}</p>
          <p><strong>Duration:</strong> {{service.durationInMinutes}} minutes</p>
          <p><strong>Price:</strong> ₱{{service.price}}</p>
        </div>
      </div>
    </div>

    <div class="selected-services" *ngIf="selectedServices.length > 0">
      <h3>Selected Services</h3>
      <div *ngFor="let service of selectedServices" class="service-item">
        <div>
          <strong>{{service.name}}</strong> - ₱{{service.price}}
        </div>
        <button class="btn btn-danger" (click)="removeService(service.id)">Remove</button>
      </div>
      <div class="total-amount">Total: ₱{{totalAmount}}</div>
    </div>

    <div class="form-section">
      <div class="form-group">
        <label>Number of Guests (including yourself)</label>
        <input type="number" 
               [(ngModel)]="bookingForm.guestCount" 
               min="1" 
               max="10">
      </div>
    </div>

    <div class="button-group">
      <div></div>
      <button class="btn btn-primary" (click)="nextStep()">Next</button>
    </div>
  </div>


  <div *ngIf="step === 2">
    <h2>Guest Information</h2>
    
    <div class="form-section">
      <h3>Primary Guest (You)</h3>
      <div class="form-group">
        <label>Full Name *</label>
        <input type="text" [(ngModel)]="bookingForm.customerName" required>
      </div>
      <div class="form-group">
        <label>Email *</label>
        <input type="email" [(ngModel)]="bookingForm.email" required>
      </div>
      <div class="form-group">
        <label>Phone *</label>
        <input type="tel" [(ngModel)]="bookingForm.phone" required>
      </div>
    </div>

    <div *ngIf="bookingForm.guestCount > 1">
      <h3>Additional Guests</h3>
      <div *ngFor="let guest of bookingForm.guests; let i = index" class="guest-form">
        <h4>Guest {{i + 2}}</h4>
        <div class="form-group">
          <label>Name</label>
          <input type="text" [(ngModel)]="guest.name">
        </div>
        <div class="form-group">
          <label>Special Preferences</label>
          <textarea [(ngModel)]="guest.preferences" rows="2"></textarea>
        </div>
      </div>
    </div>

    <div class="button-group">
      <button class="btn btn-secondary" (click)="previousStep()">Back</button>
      <button class="btn btn-primary" (click)="nextStep()">Next</button>
    </div>
  </div>


  <div *ngIf="step === 3">
    <h2>Select Date & Time</h2>
    
    <div class="form-section">
      <div class="form-group">
        <label>Preferred Date *</label>
        <input type="date" 
               [(ngModel)]="bookingForm.selectedDate"
               (change)="onDateChange(bookingForm.selectedDate)"
               [min]="getTodayDate()">
      </div>

      <div class="form-group" *ngIf="availableSlots.length > 0">
        <label>Available Time Slots</label>
        <div class="time-slots">
          <div *ngFor="let slot of availableSlots"
               class="time-slot"
               [class.selected]="bookingForm.selectedTime === slot.slotTime"
               (click)="bookingForm.selectedTime = slot.slotTime">
            {{slot.slotTime}}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Preferred Therapist (Optional)</label>
        <select [(ngModel)]="bookingForm.therapistId">
          <option [value]="null">Any Available</option>
          <option *ngFor="let therapist of therapists" [value]="therapist.id">
            {{therapist.firstName}} {{therapist.lastName}} - {{therapist.specialization}}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>Special Notes</label>
        <textarea [(ngModel)]="bookingForm.notes" rows="4"></textarea>
      </div>
    </div>

    <div class="button-group">
      <button class="btn btn-secondary" (click)="previousStep()">Back</button>
      <button class="btn btn-primary" (click)="nextStep()">Next</button>
    </div>
  </div>

  <div *ngIf="step === 4">
    <h2>Confirm Your Booking</h2>
    
    <div class="confirmation-box">
      <h3>Booking Summary</h3>
      
      <div><strong>Name:</strong> {{bookingForm.customerName}}</div>
      <div><strong>Email:</strong> {{bookingForm.email}}</div>
      <div><strong>Phone:</strong> {{bookingForm.phone}}</div>
      <div><strong>Date:</strong> {{bookingForm.selectedDate}}</div>
      <div><strong>Time:</strong> {{bookingForm.selectedTime}}</div>
      <div><strong>Guests:</strong> {{bookingForm.guestCount}}</div>
      
      <h4>Services:</h4>
      <ul>
        <li *ngFor="let service of selectedServices">
          {{service.name}} - ₱{{service.price}}
        </li>
      </ul>
      
      <div class="total-amount">Total Amount: ₱{{totalAmount}}</div>
      
      <p *ngIf="bookingForm.notes"><strong>Notes:</strong> {{bookingForm.notes}}</p>
    </div>

    <div class="button-group">
      <button class="btn btn-secondary" (click)="previousStep()">Back</button>
      <button class="btn btn-primary" (click)="submitBooking()">Confirm Booking</button>
    </div>
  </div>
</div>

</html>